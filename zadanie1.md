# Instructions
This file contains instructions on building, running and inspecting the image generated from the sources in this repo.

## Building the image
After pulling the repo's contents, cd into the pulled directory and run the following command to build a Docker image:
```
docker image build --tag ip_time .
```

## Running the container
To start a container from the built image, run:
```
docker run -d -p 8080:80 --name ip_time_server ip_time
```
If you need to, you can change the port number (8000).

## Getting info from log file
To access the informations generated by the container, execute:
```
docker exec ip_time_server /bin/cat /var/www/logs/start.log
```

## Chcecking the number of image layers
If you want to display the image's layers, type the following:
```
docker image inspect ip_time:latest | jq '[.[0]."RootFS"]'
```

## Check what it does
To check if the container works, enter [http://localhost:8000](http://localhost:8000) from your web browser. If you have changed the port number, you also need to modify it in the URL.

## Building the image for multiple platforms with buildx
If you need the image for other hardware platforms, do the following:
1. Run the multiarch/qemu-user-static container to enable building for other platforms (unless you have it installed on the host):
```
docker run --rm --privileged multiarch/qemu-user-static --reset -p yes
```
2. Create a buildx environment:
```
docker buildx create --name qemu-container
docker buildx use qemu-container
docker buildx inspect --bootstrap
```
3. Build the image with buildx, specify the hardware platforms and optionally the repo to push (if you do not want to push the image, remove the `--push` option):
```
docker buildx build -t repo/ip_time --platform linux/arm/v7,linux/arm64/v8,linux/amd64 --push .
```
